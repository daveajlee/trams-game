<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       						http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd
       						http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

       <import resource="scenario-context.xml"/>
       <import resource="vehicle-context.xml"/>
       
       <bean id="databaseManager" class="de.davelee.trams.db.DatabaseManager">
       		<property name="sessionFactory" ref="sessionFactory"/>
       </bean>
       
       <bean id="driverService" class="de.davelee.trams.services.DriverService">
       		<property name="databaseManager" ref="databaseManager"/>
       </bean>
       
       <bean id="routeService" class="de.davelee.trams.services.RouteService">
		   <property name="scenarioFactory" ref="scenarioFactory"/>
       </bean>
       
       <bean id="routeScheduleService" class="de.davelee.trams.services.RouteScheduleService">
       </bean>
       
       <bean id="journeyService" class="de.davelee.trams.services.JourneyService">
		   <property name="databaseManager" ref="databaseManager"/>
       </bean>
       
       <bean id="vehicleService" class="de.davelee.trams.services.VehicleService">
       		<property name="databaseManager" ref="databaseManager"/>
		    <property name="vehicleFactory" ref="vehicleFactory"/>
       </bean>
       
       <bean id="journeyPatternService" class="de.davelee.trams.services.JourneyPatternService">
       </bean>
       
       <bean id="timetableService" class="de.davelee.trams.services.TimetableService">
       </bean>
       
       <bean id="scenarioService" class="de.davelee.trams.services.ScenarioService">
		    <property name="scenarioFactory" ref="scenarioFactory"/>
       </bean>
       
       <bean id="gameService" class="de.davelee.trams.services.GameService">
		   <property name="databaseManager" ref="databaseManager"/>
       </bean>

		<bean id="messageService" class="de.davelee.trams.services.MessageService">
			<property name="databaseManager" ref="databaseManager"/>
		</bean>
       
       <bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    		<property name="dataSource" ref="dataSource"/>
    		<property name="hibernateProperties">
 				<props>
    				<prop key="hibernate.dialect">org.hibernate.dialect.HSQLDialect</prop> 
    				<prop key="hibernate.show_sql">true</prop> 
    				<prop key="hibernate.hbm2ddl.auto">create</prop> 
    				<prop key="hibernate.show_sql">true</prop> 
  				</props>
     		</property>
        	<property name="annotatedClasses">
      			<list>
        			<value>de.davelee.trams.data.Driver</value>
        			<value>de.davelee.trams.data.Game</value>
        			<value>de.davelee.trams.data.Journey</value>
        			<value>de.davelee.trams.data.JourneyPattern</value>
					<value>de.davelee.trams.data.Message</value>
        			<value>de.davelee.trams.data.Route</value>
        			<value>de.davelee.trams.data.RouteSchedule</value>
        			<value>de.davelee.trams.data.Stop</value>
					<value>de.davelee.trams.data.StopTime</value>
        			<value>de.davelee.trams.data.Timetable</value>
        			<value>de.davelee.trams.data.Vehicle</value>
         		</list>
    		</property>
  		</bean>
  		
  		<tx:annotation-driven transaction-manager="txManager"/>
  		
  		<bean id="txManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
  			<property name="sessionFactory" ref="sessionFactory" />
		</bean>
  		
  		<jdbc:embedded-database id="dataSource" type="HSQL">
  		</jdbc:embedded-database>
       
</beans>